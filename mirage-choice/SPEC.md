# 蜃気楼の選択 - 仕様書

## 概要

A〜Hの選択肢からランダムに選ぶか、手動で選択できる日本語のタロットカードテーマWebアプリケーション。連続選択機能、画像対応、3Dアニメーション効果を備えた神秘的な運命選択ツール。

## 機能仕様

### 基本機能

1. **ランダム選択機能**
   - 「蜃気楼の扉を開く」ボタンで未選択の選択肢からランダムに選出
   - 選択済みの選択肢は除外される（連続選択対応）
   - 中央カードに選択結果を表示

2. **手動選択機能**
   - A〜H上部ボタンクリックで直接選択が可能
   - 上部で直接選択した場合、中央カードは「？」のまま（変更されない）
   - 選択済みボタンの再クリックで選択解除（部分リセット）可能

3. **選択履歴管理**
   - 選択済み選択肢は3Dフリップエフェクト（rotateY 180度）で視覚化
   - 選択済み後もクリック可能（選択解除のため）

4. **リセット機能**
   - 全選択履歴をクリアして初期状態に戻る
   - 中央カードも「？」状態にリセット

5. **画像表示機能**
   - `images/cards/[A-H].png` ファイルが存在する場合は画像表示
   - 画像が存在しない場合はテキスト表示（フォールバック）
   - 上部・中央それぞれ専用の表示スタイル

### UI構成

#### レイアウト構造
```
[A][B][C][D] [E][F][G][H] [リセット]  ← 上部選択エリア
              蜃気楼の選択              ← タイトル
                 ?                   ← 中央カード表示エリア
            [蜃気楼の扉を開く]          ← ランダム選択ボタン
             画像: ツユさん            ← フッター
```

#### 上部選択エリア（A-H）
- **配置**: 2ブロック構成（A-D、E-H）でE前にマージン
- **サイズ**: 45×65px、四角形（タロットカード型）
- **通常状態**: ダークブラウンのグラデーション、ゴールドボーダー
- **選択済み**: 
  - 3D回転エフェクト（rotateY 180度）
  - 画像あり時: 白背景でミニ画像表示
  - 画像なし時: ベージュ背景でテキスト表示
- **機能**: クリックで選択/選択解除の切り替え

#### 中央カード表示エリア
- **サイズ**: 180×260px、タロットカード比率
- **通常状態**: ダークブラウンのグラデーション、「？」表示
- **選択時**: 
  - 画像あり時: カード画像を表示
  - 画像なし時: ベージュ背景でオプション文字表示
- **アニメーション**: 選択時に3Dエフェクト（scale + rotateY）

#### リセットボタン
- **配置**: 上部選択エリア右側
- **スタイル**: 控えめなグレー系、透明度80%
- **機能**: 全選択状態と中央カードをクリア

#### ランダム選択ボタン
- **配置**: 中央カード下部
- **スタイル**: 青のグラデーション、ホバー時拡大
- **機能**: 未選択の選択肢からランダム選出し中央に表示

### 技術仕様

- **構成**: HTML + CSS + JavaScript（ES6+クラスベース）
- **ファイル**: index.html, style.css, script.js
- **画像**: images/cards/[A-H].png（オプション）
- **テーマ**: ダークグラデーション背景、タロットカード風デザイン
- **アニメーション**: CSS 3D transforms、0.3-0.6秒イージング
- **レスポンシブ**: flexboxレイアウト、モバイル対応

### 選択ロジック

1. **状態管理**: Set型の`selectedOptions`で選択済み管理
2. **画像処理**: Image()オブジェクトで存在確認後に表示方法決定
3. **イベント処理**: `closest()`による親要素イベントハンドリング
4. **選択解除**: 選択済みボタンクリックで中央カードを「？」に戻す

### スタイル詳細

#### カラーパレット
- **背景**: `#1a1a2e` → `#16213e`のグラデーション
- **カードベース**: `#2a1810` → `#4a2c18`のブラウングラデーション
- **選択済み**: `#f5f5dc` → `#e6ddb3`のベージュ（テキスト時）/ 白（画像時）
- **アクセント**: `#d4af37`（ゴールド）、`#4cc9f0`（ブルー）
- **テキスト**: `#e6e6e6`（メイン）、`#8b4513`（選択済み）

#### 3Dエフェクト
- **選択フリップ**: `transform: rotateY(180deg)`
- **アニメーション**: `transition: all 0.6s ease`
- **ホバー**: `transform: scale(1.05)`

#### レスポンシブ対応
- **768px以下**: ボタンサイズ縮小（35×50px）
- **カードサイズ**: 140×200px
- **フォントサイズ**: 段階的縮小